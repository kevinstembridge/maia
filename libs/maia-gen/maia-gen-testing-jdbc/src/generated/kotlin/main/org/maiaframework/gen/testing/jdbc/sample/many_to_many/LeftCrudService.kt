// This source was generated by the Mahana code generator
// Renderer class: class org.maiaframework.gen.renderers.CrudServiceRenderer

package org.maiaframework.gen.testing.jdbc.sample.many_to_many

import org.maiaframework.domain.DomainId
import org.maiaframework.problem.MaiaProblems
import org.slf4j.LoggerFactory
import org.springframework.stereotype.Component


@Component
class LeftCrudService(
    private val entityRepo: LeftRepo,
    private val mahanaProblems: MaiaProblems,
    private val manyToManyJoinRepo: ManyToManyJoinRepo
) {


    private val logger = LoggerFactory.getLogger(LeftCrudService::class.java)


    fun create(entity: LeftEntity): LeftEntity {

        this.entityRepo.insert(entity)
        return entity

    }


    fun delete(id: DomainId) {

        if (this.manyToManyJoinRepo.existsByLeftId(id)) {
            throw this.mahanaProblems.foreignKeyRecordsExist("ManyToManyJoin")
        }

        this.entityRepo.deleteById(id)

    }


}

